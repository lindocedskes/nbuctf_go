import{s as x,r,h as ue,a as de,o as _,c as h,e as n,i as S,v as H,t as F,f as u,b as e,w as a,F as ce,j as me,k as pe,l as s,n as fe,m as ge,q as ve,E as be,x as ye}from"./index-Bn-LUwQy.js";import{E as _e}from"./el-dialog-BU9AbnID.js";import{E as he,a as we}from"./el-form-item-B_8SvOew.js";import{E as xe,a as ke,b as qe}from"./el-select-C4qcOMdq.js";import"./el-checkbox-CKjpL-AX.js";import"./el-scrollbar-CLRIscds.js";import"./el-popper-BdujecIX.js";import{E as Ve}from"./el-popover-Be-ihjpi.js";import{_ as Ce,E as Fe}from"./index-Di9MCs-K.js";import{C as O}from"./common-DtW6rl7d.js";import{o as Ee,c as Te,a as Ue,b as Ie}from"./k8s-hKE2ZVKb.js";import{E as Ae}from"./style-lnHhbIl6.js";import"./refs-ByHrsHwT.js";import"./isUndefined-DCTLXrZ8.js";import"./castArray-DtDIj2Ba.js";import"./_baseClone-U68Qzn7a.js";import"./_initCloneObject-RYoY0Yuy.js";import"./strings-jSOXqs0Z.js";import"./dropdown-CeyFpMaF.js";import"./el-avatar-C6mbEiCL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DXuJMpcb.js";const Pe=()=>x({url:"/gameadmin/list",method:"get"}),De=m=>x({url:"/gameadmin/deletequestion",method:"post",data:m}),Ne=m=>x({url:"/gameadmin/createquestion",method:"post",data:m}),$=m=>x({url:"/gameadmin/editquestion",method:"post",data:m}),Me=m=>x({url:"/gameadmin/addfile",method:"post",data:m}),Se=m=>x({url:"/gameadmin/deletefiles",method:"post",data:m}),He={class:"table-box"},Oe={class:"l-list"},$e=n("label",{for:"helper-text",class:"block text-sm font-medium text-gray-900 w-1/8"},"容器镜像:",-1),Be=n("label",{for:"helper-text",class:"block mb-2 text-sm font-medium text-gray-900 w-1/8 ml-4"},"服务端口:",-1),Je={class:"w-1/3 ml-4"},Ge={key:0},Le={class:"text-gray-900 bg-gradient-to-r from-lime-200 via-lime-400 to-lime-500 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-lime-300 dark:focus:ring-lime-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center"},Qe={key:1,class:"text-white bg-gradient-to-r from-red-400 via-red-500 to-red-600 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2"},je=n("span",{class:"absolute inset-0 translate-x-1.5 translate-y-1.5 bg-yellow-300 transition-transform group-hover:translate-x-0 group-hover:translate-y-0"},null,-1),We={style:{display:"flex","flex-wrap":"wrap"}},ze={class:"text-center ml-2"},Ke=n("p",null,"确定要删除此题目吗",-1),Re={style:{"text-align":"right","margin-top":"8px"}},Xe={style:{height:"60vh",overflow:"auto",padding:"0 1px"}},Ye={class:"dialog-footer"},Ze={style:{height:"60vh",overflow:"auto",padding:"0 12px"}},et={key:0},tt={class:"text-center ml-2"},lt={key:1,class:"header-img-box","w-16":"","h-16":""},ot={class:"dialog-footer"},Ft=Object.assign({name:"GameAdmin"},{__name:"index",setup(m){const E=r([]),y=async()=>{const o=await Pe();o.code===0&&(E.value=o.data)};ue(()=>E.value,()=>{}),(async()=>{y()})();const B=o=>{switch(o.toLowerCase()){case"web":return"success";case"misc":return"info";case"crypto":return"warning";case"pwn":return"danger";default:return"primary"}},J=async o=>{(await De({id:o.id})).code===0&&(s.success("删除成功"),o.visible=!1,await y())},i=r({queType:"",queName:"",queDescribe:"",queMark:"",queFlag:"",ifHidden:!0,imageUrl:"",innerPort:""}),G=r({queType:[{required:!0,message:"请输入题目类型",trigger:"blur"}],queName:[{required:!0,message:"请输入题目名称",trigger:"blur"}],queMark:[{required:!0,message:"请输入题目分值",trigger:"blur"},{pattern:/^\d+$/,message:"请输入合法整数",trigger:"blur"}]}),T=r(null),L=async()=>{T.value.validate(async o=>{if(o){const t={...i.value};V.value==="add"&&(await Ne(t)).code===0&&(s({type:"success",message:"创建成功"}),await y(),U()),V.value==="edit"&&(await $(t)).code===0&&(s({type:"success",message:"编辑成功"}),await y(),U())}})},Q=o=>{V.value="edit",i.value=JSON.parse(JSON.stringify(o)),k.value=!0},k=r(!1),U=()=>{T.value.resetFields(),k.value=!1},V=r("add"),j=()=>{V.value="add",k.value=!0},I=r(null),g=r({files:[],id:""}),W=async()=>{const o={questionId:g.value.id,fileId:g.value.files[0].id};(await Me(o)).code===0&&(s({type:"success",message:"添加成功"}),await y(),A())},z=o=>{g.value=JSON.parse(JSON.stringify(o)),C.value=!0},K=async o=>{const t={id:o.id};(await Se(t)).code===0?(s({type:"success",message:"清空成功"}),await y()):s({type:"error",message:"清空失败"})},C=r(!1),A=()=>{I.value.resetFields(),C.value=!1},R=async o=>{i.value=JSON.parse(JSON.stringify(o)),await fe(),console.log(i.value),console.log(o);const t={...i.value};(await $(t)).code===0&&(s({type:"success",message:`${t.ifHidden===!0?"禁用":"启用"}成功`}),await y())},P=r(null),X=()=>{P.value.open()},Y=o=>{g.value.files[0]=o},p=r({containerImage:"",innerPort:80}),v=r({containerAddr:"",outPort:""}),Z=async()=>{if(!p.value.containerImage){s.error("请输入测试容器镜像地址");return}if(!p.value.innerPort){s.error("请输入测试容器内部运行端口");return}const o={imageAddr:p.value.containerImage,innerPort:p.value.innerPort};console.log(o);const t=await Ee(o);t.code===0&&(v.value=t.data,s.success(t.msg))},ee=async()=>{const o={imageAddr:p.value.containerImage},t=await Te(o);t.code===0&&(v.value=t.data,s.success(t.msg))},te=async()=>{const o={imageAddr:p.value.containerImage},t=await Ue(o);t.code===0&&(v.value=t.data,s.success(t.msg))},le=async()=>{ge.confirm("此操作将删除比赛所有容器, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const o=await Ie();o.code===0&&(v.value=o.data,s.success(o.msg))}).catch(()=>{s({type:"info",message:"已取消删除"})})},oe=()=>{window.open("http://"+v.value.containerAddr+":"+v.value.outPort)};return(o,t)=>{const q=de("Share"),ae=ve,ne=xe,d=ke,D=Fe,f=be,ie=Ve,se=qe,w=ye,b=he,N=we,M=_e;return _(),h("div",null,[n("div",He,[n("div",Oe,[$e,S(n("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>p.value.containerImage=l),type:"email",id:"helper-text","aria-describedby":"helper-text-explanation",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/4 p-2.5",placeholder:"请输入测试容器镜像地址"},null,512),[[H,p.value.containerImage]]),Be,S(n("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>p.value.innerPort=l),type:"email",id:"helper-text","aria-describedby":"helper-text-explanation",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/6 p-2.5",placeholder:"测试容器内部运行端口（一般都为80"},null,512),[[H,p.value.innerPort]]),n("div",Je,[v.value.containerAddr?(_(),h("div",Ge,[n("label",Le,F(v.value.containerAddr+":"+v.value.outPort),1),n("button",{onClick:oe,type:"button",class:"ml-2 text-gray-900 bg-gradient-to-r from-teal-200 to-lime-200 hover:bg-gradient-to-l hover:from-teal-200 hover:to-lime-200 focus:ring-4 focus:outline-none focus:ring-lime-200 dark:focus:ring-teal-700 font-medium rounded-lg text-sm px-5 py-2.5 text-center"},[u(" Open "),e(ae,{class:"#dc2626"},{default:a(()=>[e(q)]),_:1})])])):(_(),h("label",Qe," 测试容器未开启 "))])]),n("div",{class:"btn-list"},[n("a",{class:"group inline-block rounded-full bg-gradient-to-r from-pink-500 via-red-500 to-yellow-500 p-[2px] hover:text-white focus:outline-none focus:ring active:text-opacity-75",href:"#"},[n("span",{onClick:Z,class:"block rounded-full bg-white px-4 py-1 text-sm font-medium group-hover:bg-transparent"}," 开启测试容器 ")]),n("a",{class:"group inline-block rounded-full bg-gradient-to-r from-pink-500 via-red-500 to-yellow-500 p-[2px] hover:text-white focus:outline-none focus:ring active:text-opacity-75",href:"#"},[n("span",{onClick:te,class:"block rounded-full bg-white px-4 py-1 text-sm font-medium group-hover:bg-transparent"}," 删除测试容器 ")]),n("a",{class:"group inline-block rounded-full bg-gradient-to-r from-pink-500 via-red-500 to-yellow-500 p-[2px] hover:text-white focus:outline-none focus:ring active:text-opacity-75",href:"#"},[n("span",{onClick:ee,class:"block rounded-full bg-white px-4 py-1 text-sm font-medium group-hover:bg-transparent"}," 查询测试容器状态 ")]),n("button",{type:"button",onClick:le,class:"text-white bg-gradient-to-br from-pink-500 to-orange-400 hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-pink-200 dark:focus:ring-pink-800 font-medium rounded-lg text-sm px-4 py-1.5 text-center"}," 关闭所有比赛容器 ")]),n("div",{class:"btn-list"},[n("a",{class:"group relative inline-block focus:outline-none focus:ring",href:"#"},[je,n("span",{onClick:j,class:"relative inline-block border-2 border-current px-4 py-1 text-sm font-bold uppercase tracking-widest text-black group-active:text-opacity-75"}," 新增赛题 ")])]),e(se,{data:E.value,"row-key":"id"},{default:a(()=>[e(d,{align:"left",label:"题目类型","min-width":"100"},{default:a(l=>[e(ne,{type:B(l.row.queType),"disable-transitions":""},{default:a(()=>[u(F(l.row.queType),1)]),_:2},1032,["type"])]),_:1}),e(d,{align:"left",label:"id","min-width":"50",prop:"id"}),e(d,{align:"left",label:"题目名称","min-width":"150",prop:"queName"}),e(d,{align:"left",label:"题目描述","min-width":"150",prop:"queDescribe"}),e(d,{align:"left",label:"题目分值","min-width":"150",prop:"queMark"}),e(d,{align:"left",label:"解题flag","min-width":"180",prop:"queFlag"}),e(d,{align:"left",label:"启用","min-width":"150"},{default:a(l=>[e(D,{modelValue:l.row.ifHidden,"onUpdate:modelValue":c=>l.row.ifHidden=c,"inline-prompt":"","active-value":!1,"inactive-value":!0,onChange:()=>{R(l.row)}},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(d,{label:"附件","min-width":"400"},{default:a(l=>[n("div",We,[(_(!0),h(ce,null,me(l.row.files,(c,re)=>(_(),h("div",{key:re,class:"mt-2 flex items-center"},[e(O,{"pic-src":c.url,picType:"file",class:"w-14 h-12"},null,8,["pic-src"]),n("div",ze,F(c.name),1)]))),128))])]),_:1}),e(d,{align:"left",label:"靶机地址","min-width":"180",prop:"imageUrl"}),e(d,{align:"left",label:"靶机内部运行端口","min-width":"180",prop:"innerPort"}),e(d,{label:"操作","min-width":"350",fixed:"right"},{default:a(l=>[e(ie,{visible:l.row.visible,"onUpdate:visible":c=>l.row.visible=c,placement:"top",width:"160"},{reference:a(()=>[e(f,{type:"primary",link:"",icon:"delete",class:"text-emerald-400"},{default:a(()=>[u("删除")]),_:1})]),default:a(()=>[Ke,n("div",Re,[e(f,{type:"primary",link:"",onClick:c=>l.row.visible=!1},{default:a(()=>[u("取消")]),_:2},1032,["onClick"]),e(f,{type:"primary",onClick:c=>J(l.row)},{default:a(()=>[u("确定")]),_:2},1032,["onClick"])])]),_:2},1032,["visible","onUpdate:visible"]),e(f,{type:"primary",link:"",icon:"edit",onClick:c=>Q(l.row),class:"text-emerald-400"},{default:a(()=>[u("编辑")]),_:2},1032,["onClick"]),e(f,{type:"primary",link:"",icon:"Link",onClick:c=>z(l.row),class:"text-emerald-400"},{default:a(()=>[u("添加附件")]),_:2},1032,["onClick"]),e(f,{type:"primary",link:"",icon:"Link",onClick:c=>K(l.row),class:"text-emerald-400"},{default:a(()=>[u("清空附件")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),e(M,{modelValue:k.value,"onUpdate:modelValue":t[10]||(t[10]=l=>k.value=l),title:"赛题","show-close":!1,"close-on-click-modal":!1,class:"w-3/5"},{footer:a(()=>[n("div",Ye,[e(f,{onClick:U},{default:a(()=>[u("取 消")]),_:1}),e(f,{type:"primary",onClick:L},{default:a(()=>[u("确 定")]),_:1})])]),default:a(()=>[n("div",Xe,[e(N,{ref_key:"questionForm",ref:T,rules:G.value,model:i.value,"label-width":"100px"},{default:a(()=>[e(b,{label:"题目类型",prop:"queType"},{default:a(()=>[e(w,{modelValue:i.value.queType,"onUpdate:modelValue":t[2]||(t[2]=l=>i.value.queType=l)},null,8,["modelValue"])]),_:1}),e(b,{label:"题目名称",prop:"queName"},{default:a(()=>[e(w,{modelValue:i.value.queName,"onUpdate:modelValue":t[3]||(t[3]=l=>i.value.queName=l)},null,8,["modelValue"])]),_:1}),e(b,{label:"题目描述",prop:"queDescribe"},{default:a(()=>[e(pe(Ae),{modelValue:i.value.queDescribe,"onUpdate:modelValue":t[4]||(t[4]=l=>i.value.queDescribe=l),class:"h-80 text-left"},null,8,["modelValue"])]),_:1}),e(b,{label:"题目分值",prop:"queMark"},{default:a(()=>[e(w,{modelValue:i.value.queMark,"onUpdate:modelValue":t[5]||(t[5]=l=>i.value.queMark=l),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(b,{label:"解题flag",prop:"queFlag"},{default:a(()=>[e(w,{modelValue:i.value.queFlag,"onUpdate:modelValue":t[6]||(t[6]=l=>i.value.queFlag=l)},null,8,["modelValue"])]),_:1}),e(b,{label:"靶机地址",prop:"queFlag"},{default:a(()=>[e(w,{modelValue:i.value.imageUrl,"onUpdate:modelValue":t[7]||(t[7]=l=>i.value.imageUrl=l)},null,8,["modelValue"])]),_:1}),e(b,{label:"靶机内部端口",prop:"queFlag"},{default:a(()=>[e(w,{modelValue:i.value.innerPort,"onUpdate:modelValue":t[8]||(t[8]=l=>i.value.innerPort=l)},null,8,["modelValue"])]),_:1}),e(b,{label:"启用",prop:"ifHidden"},{default:a(()=>[e(D,{modelValue:i.value.ifHidden,"onUpdate:modelValue":t[9]||(t[9]=l=>i.value.ifHidden=l),"inline-prompt":"","active-value":!1,"inactive-value":!0},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])])]),_:1},8,["modelValue"]),e(M,{modelValue:C.value,"onUpdate:modelValue":t[11]||(t[11]=l=>C.value=l),title:"添加附件","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1},{footer:a(()=>[n("div",ot,[e(f,{onClick:A},{default:a(()=>[u("取 消")]),_:1}),e(f,{type:"primary",onClick:W},{default:a(()=>[u("确 定")]),_:1})])]),default:a(()=>[n("div",Ze,[e(N,{ref_key:"fileForm",ref:I,"label-width":"80px",model:g.value},{default:a(()=>[e(b,{label:"附件","label-width":"80px"},{default:a(()=>[n("div",{style:{display:"inline-block"},onClick:X},[g.value.files.length>0?(_(),h("div",et,[e(O,{"pic-src":g.value.files[0].url,picType:"file"},null,8,["pic-src"]),n("div",tt,F(g.value.files[0].name),1)])):(_(),h("div",lt,"从文件库选择"))])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),e(Ce,{ref_key:"chooseImg",ref:P,target:g.value.files[0],"target-key":"url",onUpdateFiles:Y},null,8,["target"])])}}});export{Ft as default};
