import{r as u,a4 as j,u as oe,h as se,bT as E,l as V,a as y,o as T,c as $,e as s,f as n,t as w,k as I,b as e,w as o,ad as S,bU as te,q as ae,x as ne,E as de}from"./index-Bn-LUwQy.js";import{E as re}from"./el-dialog-BU9AbnID.js";import{E as ue,a as ie}from"./el-form-item-B_8SvOew.js";import{E as ce,a as me}from"./el-tab-pane-BILPqLrS.js";import"./refs-ByHrsHwT.js";import"./isUndefined-DCTLXrZ8.js";import"./castArray-DtDIj2Ba.js";import"./_baseClone-U68Qzn7a.js";import"./_initCloneObject-RYoY0Yuy.js";import"./strings-jSOXqs0Z.js";const pe={class:"grid grid-cols-12 w-full gap-2"},fe={class:"col-span-3 h-full"},_e={class:"w-full h-full bg-white px-4 py-8 rounded-lg shadow-lg box-border"},ve={class:"user-card px-6 text-center bg-white shrink-0"},ge={class:"py-6 text-center"},we={key:0,class:"text-3xl flex justify-center items-center gap-4"},he={key:1,class:"flex justify-center items-center gap-4"},be=s("p",{class:"text-gray-500 mt-2 text-md"}," 这个家伙很懒，什么都没有留下 ",-1),xe={class:"w-full h-full text-left"},Ve={class:"inline-block h-full w-full"},ye={class:"info-list"},ke={class:"info-list"},Ce={class:"col-span-9"},Pe={class:"bg-white h-full px-4 py-8 rounded-lg shadow-lg box-border text-left"},Ee={class:"borderd"},Ie=s("p",{class:"pb-2.5 text-xl text-gray-600"},"联系手机",-1),Ue={class:"pb-2.5 text-lg text-gray-400"},Ne={class:"borderd pt-2.5"},Fe=s("p",{class:"pb-2.5 text-xl text-gray-600"},"联系邮箱",-1),je={class:"pb-2.5 text-lg text-gray-400"},Te={class:"borderd pt-2.5"},$e=s("p",{class:"pb-2.5 text-xl text-gray-600"},"修改密码",-1),qe={class:"pb-2.5 text-lg text-gray-400"},Be={class:"dialog-footer"},Re={class:"flex w-full gap-4"},Se={class:"dialog-footer"},De={class:"flex w-full gap-4"},Le={class:"dialog-footer"},Ye=Object.assign({name:"Person"},{__name:"person",setup(Me){const q=u("second"),D=j({password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"最少6个字符",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"最少6个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请输入确认密码",trigger:"blur"},{min:6,message:"最少6个字符",trigger:"blur"},{validator:(a,l,P)=>{l!==d.value.newPassword?P(new Error("两次密码不一致")):P()},trigger:"blur"}]}),r=oe(),U=u(null),h=u(!1),d=u({}),f=u(""),b=u(!1),L=async()=>{U.value.validate(a=>{if(a)te({password:d.value.password,newPassword:d.value.newPassword}).then(l=>{l.code===0&&V.success("修改密码成功！"),h.value=!1});else return!1})},M=()=>{d.value={password:"",newPassword:"",confirmPassword:""},U.value.clearValidate()};se(()=>r.userInfo.headerImg,async a=>{(await E({headerImg:a})).code===0&&(r.ResetUserInfo({headerImg:a}),V({type:"success",message:"设置成功"}))});const O=()=>{f.value=r.userInfo.nickName,b.value=!0},z=()=>{f.value="",b.value=!1},A=async()=>{(await E({nickName:f.value})).code===0&&(r.ResetUserInfo({nickName:f.value}),V({type:"success",message:"设置成功"})),f.value="",b.value=!1},G=(a,l)=>{console.log(a,l)},k=u(!1),v=u(0),i=j({phone:"",code:""}),H=async()=>{v.value=60;let a=setInterval(()=>{v.value--,v.value<=0&&(clearInterval(a),a=null)},1e3)},B=()=>{k.value=!1,i.phone="",i.code=""},J=async()=>{(await E({phone:i.phone})).code===0&&(V.success("修改成功"),r.ResetUserInfo({phone:i.phone}),B())},C=u(!1),g=u(0),c=j({email:"",code:""}),K=async()=>{g.value=60;let a=setInterval(()=>{g.value--,g.value<=0&&(clearInterval(a),a=null)},1e3)},R=()=>{C.value=!1,c.email="",c.code=""},Q=async()=>{(await E({email:c.email})).code===0&&(V.success("修改成功"),r.ResetUserInfo({email:c.email}),R())};return(a,l)=>{const P=y("edit"),x=ae,m=ne,W=y("check"),X=y("close"),Y=y("user"),Z=y("Location"),ee=ce,le=me,_=ue,N=ie,p=de,F=re;return T(),$("div",null,[s("div",pe,[s("div",fe,[s("div",_e,[s("div",ve,[s("div",ge,[b.value?S("",!0):(T(),$("p",we,[n(w(I(r).userInfo.nickName)+" ",1),e(x,{class:"cursor-pointer text-sm",color:"#66b1ff",onClick:O},{default:o(()=>[e(P)]),_:1})])),b.value?(T(),$("p",he,[e(m,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=t=>f.value=t)},null,8,["modelValue"]),e(x,{class:"cursor-pointer",color:"#67c23a",onClick:A},{default:o(()=>[e(W)]),_:1}),e(x,{class:"cursor-pointer",color:"#f23c3c",onClick:z},{default:o(()=>[e(X)]),_:1})])):S("",!0),be]),s("div",xe,[s("ul",Ve,[s("li",ye,[e(x,null,{default:o(()=>[e(Y)]),_:1}),n(" "+w(I(r).userInfo.userName),1)]),s("li",ke,[e(x,null,{default:o(()=>[e(Z)]),_:1}),n(" 中国·宁波市·江北区 ")])])])])])]),s("div",Ce,[s("div",Pe,[e(le,{modelValue:q.value,"onUpdate:modelValue":l[4]||(l[4]=t=>q.value=t),onTabClick:G},{default:o(()=>[e(ee,{label:"账号绑定",name:"second"},{default:o(()=>[s("ul",null,[s("li",Ee,[Ie,s("p",Ue,[n(" 绑定手机:"+w(I(r).userInfo.phone)+" ",1),s("a",{href:"javascript:void(0)",class:"float-right text-blue-400",onClick:l[1]||(l[1]=t=>k.value=!0)},"立即修改")])]),s("li",Ne,[Fe,s("p",je,[n(" 绑定邮箱："+w(I(r).userInfo.email)+" ",1),s("a",{href:"javascript:void(0)",class:"float-right text-blue-400",onClick:l[2]||(l[2]=t=>C.value=!0)},"立即修改")])]),s("li",Te,[$e,s("p",qe,[n(" 修改个人密码 "),s("a",{href:"javascript:void(0)",class:"float-right text-blue-400",onClick:l[3]||(l[3]=t=>h.value=!0)},"修改密码")])])])]),_:1})]),_:1},8,["modelValue"])])])]),e(F,{modelValue:h.value,"onUpdate:modelValue":l[9]||(l[9]=t=>h.value=t),title:"修改密码",width:"360px",onClose:M},{footer:o(()=>[s("div",Be,[e(p,{onClick:l[8]||(l[8]=t=>h.value=!1)},{default:o(()=>[n("取 消")]),_:1}),e(p,{type:"primary",onClick:L},{default:o(()=>[n("确 定")]),_:1})])]),default:o(()=>[e(N,{ref_key:"modifyPwdForm",ref:U,model:d.value,rules:D,"label-width":"80px"},{default:o(()=>[e(_,{minlength:6,label:"原密码",prop:"password"},{default:o(()=>[e(m,{modelValue:d.value.password,"onUpdate:modelValue":l[5]||(l[5]=t=>d.value.password=t),"show-password":""},null,8,["modelValue"])]),_:1}),e(_,{minlength:6,label:"新密码",prop:"newPassword"},{default:o(()=>[e(m,{modelValue:d.value.newPassword,"onUpdate:modelValue":l[6]||(l[6]=t=>d.value.newPassword=t),"show-password":""},null,8,["modelValue"])]),_:1}),e(_,{minlength:6,label:"确认密码",prop:"confirmPassword"},{default:o(()=>[e(m,{modelValue:d.value.confirmPassword,"onUpdate:modelValue":l[7]||(l[7]=t=>d.value.confirmPassword=t),"show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(F,{modelValue:k.value,"onUpdate:modelValue":l[12]||(l[12]=t=>k.value=t),title:"绑定手机",width:"600px"},{footer:o(()=>[s("span",Se,[e(p,{onClick:B},{default:o(()=>[n("取消")]),_:1}),e(p,{type:"primary",onClick:J},{default:o(()=>[n("更改")]),_:1})])]),default:o(()=>[e(N,{model:i},{default:o(()=>[e(_,{label:"手机号","label-width":"120px"},{default:o(()=>[e(m,{modelValue:i.phone,"onUpdate:modelValue":l[10]||(l[10]=t=>i.phone=t),placeholder:"请输入手机号",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(_,{label:"验证码","label-width":"120px"},{default:o(()=>[s("div",Re,[e(m,{modelValue:i.code,"onUpdate:modelValue":l[11]||(l[11]=t=>i.code=t),class:"flex-1",autocomplete:"off",placeholder:"待实现",style:{width:"300px"}},null,8,["modelValue"]),e(p,{type:"primary",disabled:v.value>0,onClick:H},{default:o(()=>[n(w(v.value>0?`(${v.value}s)后重新获取`:"获取验证码"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(F,{modelValue:C.value,"onUpdate:modelValue":l[15]||(l[15]=t=>C.value=t),title:"绑定邮箱",width:"600px"},{footer:o(()=>[s("span",Le,[e(p,{onClick:R},{default:o(()=>[n("取消")]),_:1}),e(p,{type:"primary",onClick:Q},{default:o(()=>[n("更改")]),_:1})])]),default:o(()=>[e(N,{model:c},{default:o(()=>[e(_,{label:"邮箱","label-width":"120px"},{default:o(()=>[e(m,{modelValue:c.email,"onUpdate:modelValue":l[13]||(l[13]=t=>c.email=t),placeholder:"请输入邮箱",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(_,{label:"验证码","label-width":"120px"},{default:o(()=>[s("div",De,[e(m,{modelValue:c.code,"onUpdate:modelValue":l[14]||(l[14]=t=>c.code=t),class:"flex-1",placeholder:"待实现，仅模拟",autocomplete:"off",style:{width:"300px"}},null,8,["modelValue"]),e(p,{type:"primary",disabled:g.value>0,onClick:K},{default:o(()=>[n(w(g.value>0?`(${g.value}s)后重新获取`:"获取验证码"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{Ye as default};
